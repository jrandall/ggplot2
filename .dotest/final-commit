Experimental rewrite of legend to use new way
